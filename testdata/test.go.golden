package testdata

import (
	"fmt"

	"github.com/ghostiam/protogetter/testdata/proto"
)

type Test struct {
	Embedded *proto.Embedded
}

func testInvalid(t *proto.Test) {
	func(...interface{}) {}(t.GetB(), t.GetD()) // want "avoid direct access to proto field" "avoid direct access to proto field"
	func(...interface{}) {}(t.GetB(), t.GetD()) // want "avoid direct access to proto field"
	func(...interface{}) {}(t.GetB(), t.GetD()) // want "avoid direct access to proto field"

	_ = t.GetD()                                                  // want "avoid direct access to proto field"
	_ = t.GetF()                                                  // want "avoid direct access to proto field"
	_ = t.GetI32()                                                // want "avoid direct access to proto field"
	_ = t.GetI64()                                                // want "avoid direct access to proto field"
	_ = t.GetU32()                                                // want "avoid direct access to proto field"
	_ = t.GetU64()                                                // want "avoid direct access to proto field"
	_ = t.GetT()                                                  // want "avoid direct access to proto field"
	_ = t.GetB()                                                  // want "avoid direct access to proto field"
	_ = t.GetS()                                                  // want "avoid direct access to proto field"
	_ = t.GetEmbedded()                                           // want "avoid direct access to proto field"
	_ = t.GetEmbedded().GetS()                                    // want "avoid direct access to proto field"
	_ = t.GetEmbedded().GetS()                                    // want "avoid direct access to proto field"
	_ = t.GetEmbedded().GetEmbedded()                             // want "avoid direct access to proto field"
	_ = t.GetEmbedded().GetEmbedded()                             // want "avoid direct access to proto field"
	_ = t.GetEmbedded().GetEmbedded().GetS()                      // want "avoid direct access to proto field"
	_ = t.GetEmbedded().GetEmbedded().GetS()                      // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()                                  // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[0]                               // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[0].GetS()                        // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[0].GetS()                        // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[0].GetEmbedded()                 // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[0].GetEmbedded()                 // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[0].GetEmbedded().GetS()          // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[0].GetEmbedded().GetS()          // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[t.GetI64()].GetEmbedded().GetS() // want "avoid direct access to proto field"
	_ = t.GetRepeatedEmbeddeds()[t.GetI64()].GetEmbedded().GetS() // want "avoid direct access to proto field"

	var many []*proto.Test
	manyIndex := 42

	_ = many[0].GetT()                             // want "avoid direct access to proto field"
	_ = many[1].GetEmbedded().GetS()               // want "avoid direct access to proto field"
	_ = many[2].GetEmbedded().GetS()               // want "avoid direct access to proto field"
	_ = many[3].GetEmbedded().GetEmbedded().GetS() // want "avoid direct access to proto field"
	_ = many[manyIndex].GetS()                     // want "avoid direct access to proto field"

	test := many[0].GetEmbedded().GetS() == "" || t.GetEmbedded().CustomMethod() == nil || t.GetS() == "" || t.GetEmbedded() == nil // want "avoid direct access to proto field" "avoid direct access to proto field" "avoid direct access to proto field" "avoid direct access to proto field"
	_ = test

	other := proto.Other{}
	_ = other.MyMethod(nil).GetS() // want "avoid direct access to proto field"

	ems := t.GetRepeatedEmbeddeds() // want "avoid direct access to proto field"
	_ = ems[len(ems)-1].GetS()      // want "avoid direct access to proto field"

	ch := make(chan string)
	ch <- t.GetS() // want "avoid direct access to proto field"

	for _, v := range t.GetRepeatedEmbeddeds() { // want "avoid direct access to proto field"
		_ = v
	}
}

func testValid(t *proto.Test) {
	func(...interface{}) {}(t.GetB(), t.GetD())

	_, t.T = true, true
	_, t.T, _ = true, true, false
	_, _, t.T = true, true, false
	t.T, _ = true, true
	t.D = 2
	t.I32++
	t.I32 += 2

	fmt.Scanf("Test", &t.S, &t.B, &t.T)

	t.D = 1.0
	t.F = 1.0
	t.I32 = 1
	t.I64 = 1
	t.U32 = 1
	t.U64 = 1
	t.T = true
	t.B = []byte{1}
	t.S = "1"
	t.Embedded = &proto.Embedded{}
	t.Embedded.S = "1"
	t.GetEmbedded().S = "1"
	t.Embedded.Embedded = &proto.Embedded{}
	t.GetEmbedded().Embedded = &proto.Embedded{}
	t.Embedded.Embedded.S = "1"
	t.GetEmbedded().GetEmbedded().S = "1"
	t.RepeatedEmbeddeds = []*proto.Embedded{{S: "1"}}

	_ = t.GetD()
	_ = t.GetF()
	_ = t.GetI32()
	_ = t.GetI64()
	_ = t.GetU32()
	_ = t.GetU64()
	_ = t.GetT()
	_ = t.GetB()
	_ = t.GetS()
	_ = t.GetEmbedded()
	_ = t.GetEmbedded().GetS()
	_ = t.GetEmbedded().GetEmbedded()
	_ = t.GetEmbedded().GetEmbedded().GetS()
	_ = t.GetRepeatedEmbeddeds()
	_ = t.GetRepeatedEmbeddeds()[0]
	_ = t.GetRepeatedEmbeddeds()[0].GetS()
	_ = t.GetRepeatedEmbeddeds()[0].GetEmbedded()
	_ = t.GetRepeatedEmbeddeds()[0].GetEmbedded().GetS()

	other := proto.Other{}
	other.MyMethod(nil).CustomMethod()
	other.MyMethod(nil).GetS()

	var tt Test
	_ = tt.Embedded.GetS()
	_ = tt.Embedded.GetEmbedded().GetS()

	ems := t.GetRepeatedEmbeddeds()
	_ = ems[len(ems)-1].GetS()

	ch := make(chan string)
	ch <- t.GetS()
}
